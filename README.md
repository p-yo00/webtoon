## 웹툰 서비스
작가에게 후원 댓글을 보낼 수 있는 웹툰 api 서비스입니다.

## 사용 기술
<div align=center>
<img src="https://img.shields.io/badge/Spring boot-6DB33F?style=for-the-badge&logo=springboot&logoColor=white"> <img src="https://img.shields.io/badge/Spring security-6DB33F?style=for-the-badge&logo=springsecurity&logoColor=white">
  
<img src="https://img.shields.io/badge/mysql-4479A1?style=for-the-badge&logo=mysql&logoColor=white"> <img src="https://img.shields.io/badge/Elastic Search-005571?style=for-the-badge&logo=elasticsearch&logoColor=white"> <img src="https://img.shields.io/badge/Redis-FF4438?style=for-the-badge&logo=redis&logoColor=white">
<img src="https://img.shields.io/badge/Amazon S3-569A31?style=for-the-badge&logo=amazons3&logoColor=white"> 
</div>

## ERD
<img src="https://github.com/p-yo00/webtoon/blob/main/doc/img/erd.png">

## 프로젝트 기능

### [회원]

- 회원가입
    - 아이디, 비밀번호, 이름, 성인인증 여부, 권한을 입력하여 가입한다.
    - [일반 사용자(GENERAL) / 작가(AUTHOR) / 관리자(MANAGER)] 권한으로 가입할 수 있다.


- 로그인
  - 쿠키에 저장된 jwt 토큰을 통해 인증을 수행한다.


- 회원 수정
  - 비밀번호와 이름을 수정할 수 있다.
  - 성인인증을 통해 성인인증 날짜를 업데이트할 수 있다.


- 회원 탈퇴
  - 탈퇴 시 삭제 대신 탈퇴일시 컬럼값을 수정한다.


### [웹툰]

- 웹툰 등록
    - 작품명, 작품 설명, 키워드, 대표 이미지, 장르, 연령제한, 업로드 주기, 후원 알림 설정을 입력하여 등록한다.
    - 작가에게 웹툰 등록 권한이 있다.
    - 연령 제한 설정 시, 1년 이내로 성인인증이 된 사용자만 웹툰의 에피소드를 조회할 수 있다.
    - 후원 알림 설정을 통해 웹툰에 후원 댓글이 들어올 때 알림을 받을지 설정한다.
    - 공개 여부는 작가가 처음 등록 시, 비공개로 등록되며 관리자의 승인 이후 공개로 설정된다.


- 웹툰 정보 수정
  - 작가는 작품 설명, 키워드, 대표 이미지 URL, 업로드 주기, 후원 알림 설정, 완결 여부를 수정할 수 있다.
  - 관리자는 작품명, 장르, 연령제한, 공개 여부를 수정할 수 있다.


- 웹툰 삭제
    - 삭제는 관리자가 공개 여부를 비공개로 바꾸는 방식으로 한다.


- 웹툰 조회
  - 조회수가 높은 순, 최근 업로드 순, 찜이 많은 순으로 정렬하여 조회할 수 있다.
    - 조회수는 총조회수 또는 캐시 서버에 저장되는 당일 조회수로 구분하여 조회할 수 있다.
    - 최근 업로드 웹툰은 에피소드의 업로드 일시를 통해 당일 업로드 된 웹툰을 조회한다.
    - 찜이 많은 웹툰은 찜목록에서 각 웹툰의 카운트를 구해 조회한다.
  - 완결작, 미완결작, 장르별로 분류하여 조회할 수 있다.
  - 사용자 맞춤 추천 웹툰을 조회할 수 있다.
    - 사용자가 가장 많이 본 웹툰의 장르에서 아직 사용자가 보지 않고 조회수가 높은 웹툰을 추천한다.
  - 사용자별 찜 설정한 웹툰을 조회할 수 있다.
  - 키워드, 작가, 제목으로 검색하여 조회할 수 있다.
    - 검색어 자동 완성을 제공한다.
  - 최근 본 웹툰은 쿠키에 저장되어 3개까지 조회할 수 있다.

### [웹툰 알림 설정]

- 알림 설정할 웹툰 추가
  - 알림 설정해 둔 웹툰은 업로드되면 사용자에게 알림을 보내 알린다.

  
- 알림 설정된 웹툰 삭제
  - 기존에 알림 설정해 둔 웹툰을 삭제한다.

### [에피소드]

> 에피소드는 웹툰 안에 있는 각 편을 뜻한다. (1편, 2편..)

- 에피소드 업로드
  - 에피소드 제목, 썸네일, 이미지들(리스트에 **순서대로** 저장) 업로드하여 저장한다.
    - 이미지가 하나도 없으면 업로드 할 수 없다.
  - 업로드 날짜는 최근 에피소드 업로드 일에서 웹툰의 업로드 주기를 더한 날짜가 되며, 해당 날짜가 지나야 조회할 수 있다.
  - 에피소드 상태는 [업로드 예정(Scheduled), 업로드 완료(Completed), 삭제(Deleted)] 가 될 수 있다.


- 에피소드 수정
  - 수정은 등록과 동일하게 제목, 썸네일, 이미지들을 수정할 수 있다.


- 에피소드 삭제
    - 삭제는 관리자가 에피소드 상태를 삭제로 바꾸는 방식으로 한다.


- 에피소드 조회
  - 웹툰에 업로드된 모든 에피소드의 썸네일, 제목, 회차, 해당 에피소드의 열람 내역을 조회한다.
  - 특정 에피소드에 저장된 이미지들을 조회한다.
    - 조회 시, 웹툰의 조회수가 증가하고 사용자의 에피소드 열람 내역에 기록된다.


### [댓글]

- 댓글 작성
  - 각 에피소드에는 댓글을 작성할 수 있다.


- 후원 댓글 작성
  - 댓글 작성 시, 사용자가 소유한 포인트를 같이 보낼 수 있다.
  - 포인트는 30%의 수수료를 제외한 금액이 작가의 포인트로 추가된다.


- 댓글 추천
  - 작성한 댓글은 사용자마다 1번씩 추천할 수 있다.


- 댓글 삭제
  - 댓글 작성자와 댓글이 달린 웹툰의 작가에게 삭제 권한이 있다.


- 댓글 수정
  - 작성한 댓글의 내용을 수정할 수 있다.


- 댓글 조회
  - 에피소드에 작성된 모든 댓글의 사용자, 내용을 최근 작성 순으로 조회할 수 있다.
  - 후원 댓글은 후원 금액을 함께 조회한다.
  - 추천 수가 높은 상위 10개의 댓글을 조회할 수 있다.
  - 후원 금액이 높은 상위 3개의 댓글을 조회할 수 있다.
  - 작가는 후원 댓글만 따로 조회할 수 있다.


### [포인트]

- 포인트 내역 기록
  - 사용자의 포인트에 변화가 생길 때마다 기록한다.
  - 거래 종류는 [포인트 충전(deposit), 포인트 출금(withdraw), 후원(donation)] 이 있다.
  - 충전 또는 출금일 때는 입출금에 사용된 계좌번호, 은행명을 참조할 수 있다.
  - 후원일 때는 포인트를 사용한 후원에 대한 정보를 참조할 수 있다.


### [#추가 기능]

- 웹툰의 업로드 예정일 하루 전 작가에게 알림을 전송한다.

<br>

## Trouble Shooting
[go to the trouble shooting section](doc/TROUBLE_SHOOTING.md)
